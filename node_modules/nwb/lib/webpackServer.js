'use strict';

exports.__esModule = true;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _createServerWebpackConfig = require('./createServerWebpackConfig');

var _createServerWebpackConfig2 = _interopRequireDefault(_createServerWebpackConfig);

var _debug = require('./debug');

var _debug2 = _interopRequireDefault(_debug);

var _devServer = require('./devServer');

var _devServer2 = _interopRequireDefault(_devServer);

var _utils = require('./utils');

/**
 * Start a development server with Webpack using a given build configuration.
 */

exports['default'] = function (args, buildConfig, cb) {
  // Force environment to development
  process.env.NODE_ENV = 'development';

  var _buildConfig$server = buildConfig.server;
  var server = _buildConfig$server === undefined ? { staticPath: null } : _buildConfig$server;

  var webpackConfig = _createServerWebpackConfig2['default'](args, buildConfig);

  _debug2['default']('webpack config: %s', _utils.deepToString(webpackConfig));

  _devServer2['default'](webpackConfig, {
    fallback: !!args.fallback,
    host: args.host || 'localhost',
    noInfo: !args.info,
    port: args.port || 3000,
    staticPath: server.staticPath
  }, cb);
};

module.exports = exports['default'];